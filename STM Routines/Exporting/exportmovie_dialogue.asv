function exportmovie_dialogue(map,energy,rx,ry,clmap,clbnd)
%creat dialogue box
fh=figure('Name', 'Export AVI Movie',...
        'units','normalized', ...
        'Position',[0.5,0.5,0.25,0.15],...
        'Color',[0.6 0.6 0.6],...
        'MenuBar', 'none');
    axis off;
    %default path for exporting
    export_path = 'C:\Documents and Settings\Mohammad Hamidian\My Documents\Research\Data Analysis';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% GUI Controls%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    filename_entry_text = uicontrol(fh,'Style','text',...
                                       'String','Filename',...
                                       'units','normalized',...
                                       'Position',[0.04,0.7,0.15,0.12]);
            
    filename_entry = uicontrol(fh,'Style','Edit',...
                                  'units','normalized',...
                                  'Position',[0.2,0.7,0.75,0.15],...
                                  'FontWeight','Bold');  
                                                     
    fps_set = uicontrol(fh,'Style','Edit',...
                           'String','24',...
                           'units','normalized',...
                           'Position', [0.2 0.08 0.2 0.12]);
                             
    _text = uicontrol(fh,'Style','text',...
                            'String','fps',...
                            'units','normalized',...
                            'Position',[0.04,0.08,0.15,0.12]);
                        
                        
                         fps_set = uicontrol(fh,'Style','Edit',...
                           'String','24',...
                           'units','normalized',...
                           'Position', [0.2 0.08 0.2 0.12]);
                             
    fps_text = uicontrol(fh,'Style','text',...
                            'String','fps',...
                            'units','normalized',...
                            'Position',[0.04,0.08,0.15,0.12]);
                             
    dir_entry = uicontrol(fh,'Style','Edit',...
                             'String',export_path,...
                             'units','normalized',...
                             'Position',[0.2,0.5,0.75,0.15],...
                             'FontWeight','Bold'); 
                           
    dir_entry_text = uicontrol(fh,'Style','text',...
                                  'String','Directory',...
                                  'units','normalized',...
                                  'Position',[0.04,0.5,0.15,0.12]);
    
                           
    dir_choose = uicontrol(fh,'Style','pushbutton',...
                              'String','Choose Directory',...
                              'units','normalized',...
                              'Position',[0.2 0.34 0.2 0.15],...
                              'Callback',(@open_dir_Callback));   
                          
    export_but = uicontrol(fh,'Style','pushbutton',...
                              'String','Export Map!',...
                              'units','normalized',...
                              'Position',[0.75 0.1 0.2 0.3],...
                              'Callback',{@export_Callback,map,rx,ry,energy,clmap,clbnd});   

%%%%%%%%%%%%%%%%%%%%%%%%%Callback Functions%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                               
    function open_dir_Callback(hObject, evendata)                           
        exp_directory = uigetdir('C:\Documents and Settings\Mohammad Hamidian\My Documents\Research\Data Analysis');
        set(dir_entry,'String',exp_directory);
    end                
    function export_Callback(hObject,evendata,map,rx,ry,energy,clmap,clbnd)
        frps = str2num(get(fps_set,'String'));
        directory = get(dir_entry,'String');
        filename = get(filename_entry,'String');
        if directory(end) ~= '\'
            directory =  strcat(directory,'\');
        end
        if isempty(filename)
            set(filename_entry,'String','Please Enter a File Name')
            return;
        else            
            export_movie(map,energy,rx,rx,directory,filename,clmap,clbnd,frps);
        end
    end

end
